{% extends 'base.html' %}
{% block content %}
<header class="page-header">
    <div class="header-content">
        <h1 class="page-title">Your Personalized Art & Music Experience</h1>
        <p class="page-subtitle">Discover the perfect blend of visual and auditory inspiration</p>
    </div>
</header>

<main class="container mx-auto px-4 py-8">
    <div class="results-container">
        <section class="results-section">
            <h2 class="section-title">Artwork Recommendations</h2>
            <div id="artworkContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Artwork cards will be dynamically inserted here -->
            </div>
        </section>

        <section class="results-section">
            <h2 class="section-title">Music Recommendations</h2>
            <div id="musicContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Music cards will be dynamically inserted here -->
            </div>
        </section>
    </div>

    <div class="text-center mt-12">
        <a href="/" class="btn-primary">Create New Recommendations</a>
    </div>
</main>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Get stored results from localStorage
        const artworks = JSON.parse(localStorage.getItem('artworks') || '[]');
        const spotify_results = JSON.parse(localStorage.getItem('spotify_results') || '[]');
        
        // Function to create artwork cards
        function createArtworkCards() {
            const artworkContainer = document.getElementById('artworkContainer');
            
            if (artworks.length === 0) {
                artworkContainer.innerHTML = '<p class="text-center text-gray-500">No artwork recommendations available.</p>';
                return;
            }
            
            artworkContainer.innerHTML = '';
            
            artworks.forEach(artwork => {
                const card = document.createElement('div');
                card.className = 'artwork-card';
                
                let artistInfo = artwork.artistDisplayName ? 
                    `<p class="card-subtitle">${artwork.artistDisplayName}</p>` : '';
                
                let objectDate = artwork.objectDate ? 
                    `<p class="card-text">Date: ${artwork.objectDate}</p>` : '';
                
                card.innerHTML = `
                    <img src="${artwork.primaryImage || artwork.primaryImageSmall}" 
                        alt="${artwork.title}" class="artwork-image">
                    <div class="card-content">
                        <h4 class="card-title">${artwork.title}</h4>
                        ${artistInfo}
                        ${objectDate}
                        <p class="card-text">${artwork.objectName || ''}</p>
                        <a href="${artwork.objectURL}" target="_blank" class="card-link">
                            View at The Met
                        </a>
                    </div>
                `;
                
                artworkContainer.appendChild(card);
            });
        }
        
        // Function to create music cards
        function createMusicCards() {
            const musicContainer = document.getElementById('musicContainer');
            
            if (spotify_results.length === 0) {
                musicContainer.innerHTML = '<p class="text-center text-gray-500">No music recommendations available.</p>';
                return;
            }
            
            musicContainer.innerHTML = '';
            
            spotify_results.forEach(item => {
                const card = document.createElement('div');
                card.className = 'music-card';
                
                let creatorInfo = item.creator ? 
                    `<p class="card-subtitle">${item.creator}</p>` : 
                    (item.artist ? `<p class="card-subtitle">${item.artist}</p>` : '');
                
                let description = item.description ? 
                    `<p class="card-text">${item.description}</p>` : '';
                
                let additionalInfo = '';
                if (item.type === 'playlist' && item.track_count) {
                    additionalInfo = `<p class="card-text">${item.track_count} tracks</p>`;
                } else if (item.type === 'album' && item.release_date) {
                    additionalInfo = `<p class="card-text">Released: ${item.release_date}</p>`;
                } else if (item.type === 'artist' && item.genres) {
                    additionalInfo = `<p class="card-text">Genres: ${item.genres}</p>`;
                }
                
                card.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" class="music-image">
                    <div class="card-content">
                        <h4 class="card-title">${item.name}</h4>
                        ${creatorInfo}
                        ${description}
                        ${additionalInfo}
                        <a href="${item.url}" target="_blank" class="card-link">
                            Listen on Spotify
                        </a>
                    </div>
                `;
                
                musicContainer.appendChild(card);
            });
        }
        
        // Call the functions to create cards
        createArtworkCards();
        createMusicCards();
    });
</script>
{% endblock %}
